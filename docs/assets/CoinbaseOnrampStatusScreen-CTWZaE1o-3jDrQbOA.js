import{j as e}from"./vendor-wallet-iWeBopzN.js";import{F as y}from"./ArrowsRightLeftIcon-CDpYNt4X.js";import{F as v}from"./CheckCircleIcon-BMq0VCCt.js";import{r as l}from"./vendor-react-NLnOsXgy.js";import{a as b,I as j,c as p,aC as w,aD as F,aE as C}from"./index-myAZo6mG.js";import{T as S,u as k,m as D}from"./ModalHeader-D8-mhjp4-Bbauz2X0.js";import{a as I}from"./Layouts-BlFm53ED-fKsdKeCM.js";import{t as M}from"./analytics-mkkvFRju-DOXuftJB.js";const N={component:()=>{let{data:r,setModalData:t,navigate:n,navigateBack:a}=b(),{closePrivyModal:i,createAnalyticsEvent:d,client:h}=j(),[c,u]=l.useState("pending-in-flow"),m=l.useRef(0),o={...r?.funding,showAlternateFundingMethod:!0};o.usingDefaultFundingMethod&&(o.usingDefaultFundingMethod=!1);let{partnerUserId:f,popup:g}=r?.coinbaseOnrampStatus??{};return l.useEffect((()=>{if(c==="pending-in-flow"||c==="pending-after-flow"){let x=setInterval((async()=>{if(f)try{let{status:s}=await h.getCoinbaseOnRampStatus({partnerUserId:f});if(s==="success")return void u("success");if(s==="failure")throw Error("There was an error completing Coinbase Onramp flow.");if(m.current>=3)return t({funding:o,solanaFundingData:r?.solanaFundingData}),void n("FundingMethodSelectionScreen");g?.closed&&(m.current=m.current+1,u("pending-after-flow"))}catch(s){console.error(s),u("error"),d({eventName:M,payload:{status:"failure",provider:"coinbase-onramp",error:s.message}}),t({funding:{...o,errorMessage:"Something went wrong adding funds. Please try again or use another method."},solanaFundingData:r?.solanaFundingData}),n("FundingMethodSelectionScreen")}}),1500);return()=>clearInterval(x)}}),[f,g,c]),e.jsxs(e.Fragment,{children:[e.jsx(S,{title:"Fund account",backFn:()=>{t({funding:o,solanaFundingData:r?.solanaFundingData}),a()}},"header"),e.jsx(R,{status:c,onClickCta:i}),e.jsx(k,{})]})}};let R=({status:r,onClickCta:t})=>{let{title:n,body:a,cta:i}=l.useMemo((()=>(d=>{switch(d){case"success":return{title:"You've funded your account!",body:"It may take a few minutes for the assets to appear.",cta:"Continue"};case"pending-after-flow":return{title:"In Progress",body:"Almost done. Retrieving transaction status from Coinbase",cta:""};case"error":case"pending-in-flow":return{title:"In Progress",body:"Go back to Coinbase Onramp to finish funding your account.",cta:""}}})(r)),[r]);return e.jsxs(e.Fragment,{children:[e.jsxs(P,{children:[e.jsx(E,{isSucccess:r==="success"}),e.jsxs(I,{children:[e.jsx("h3",{children:n}),e.jsx(O,{children:a})]})]}),i&&e.jsx(D,{onClick:t,children:i})]})},E=({isSucccess:r})=>{if(!r){let a="var(--privy-color-foreground-4)";return e.jsxs("div",{style:{position:"relative"},children:[e.jsx(w,{color:a,style:{position:"absolute"}}),e.jsx(F,{color:a}),e.jsx(C,{style:{position:"absolute",width:"2.8rem",height:"2.8rem",top:"1.2rem",left:"1.2rem"}})]})}let t=r?v:()=>e.jsx(y,{width:"3rem",height:"3rem",style:{backgroundColor:"var(--privy-color-foreground-4)",color:"var(--privy-color-background)",borderRadius:"100%",padding:"0.5rem",margin:"0.5rem"}}),n=r?"var(--privy-color-success)":"var(--privy-color-foreground-4)";return e.jsx("div",{style:{borderColor:n,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"100%",borderWidth:2,padding:"0.5rem",marginBottom:"0.5rem"},children:t&&e.jsx(t,{width:"4rem",height:"4rem",color:n})})},O=p.p`
  font-size: 1rem;
  color: var(--privy-color-foreground-3);
  margin-bottom: 1rem;
  display: flex;
  flex-direction: column;
  gap: 1rem;
`,P=p.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  margin-left: 1.75rem;
  margin-right: 1.75rem;
  padding: 2rem 0;
`;export{N as CoinbaseOnrampStatusScreen,N as default};
