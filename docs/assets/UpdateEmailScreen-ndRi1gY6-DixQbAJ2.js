import{j as e}from"./vendor-wallet-F4boqawy.js";import{F as y}from"./EnvelopeIcon-Cr7WnWrv.js";import{e as A}from"./Layouts-BlFm53ED-B0zF6zd2.js";import{r as o}from"./vendor-react-BtAbuqlL.js";import{b as v,I as U,a as C,aA as T,r as $,bs as M,b2 as I}from"./index-D4_bkFqi.js";import{V as P,m as q}from"./ModalHeader-D8-mhjp4-BslQ1U_D.js";import{t as D,e as R}from"./EmailInputForm-Dgoii4vf-C6bMv6Tl.js";import{e as F}from"./ErrorMessage-D8VaAP5m-BW99Muke.js";import{n as W}from"./ScreenLayout-DTmQLGPf-C5KWh9uZ.js";import{M as L}from"./mail-B_5TB095.js";import"./Screen-Bp-TN9gb-CFVrYp49.js";import"./index-Dq_xe9dz-B-ZuR1jG.js";import"./createLucideIcon-BYAZb6Ze.js";const N=o.forwardRef(((s,l)=>{let[a,S]=o.useState(""),[t,c]=o.useState(""),[d,u]=o.useState(!1),{authenticated:g,user:i}=v(),{initUpdateEmail:p}=U(),{navigate:n,setModalData:f,currentScreen:w}=C(),{enabled:j,token:h}=T(),b=$(),k=M(a)&&(b.disablePlusEmails&&a.includes("+")?(t||c("Please enter a valid email address without a '+'."),!1):(t&&c(""),!0)),x=d||!k,m=()=>{!j||h||g?(async r=>{if(!i?.email)throw Error("User is required to have an email address to update it.");u(!0);try{await p({oldAddress:i.email.address,newAddress:a,captchaToken:r}),n("AwaitingPasswordlessCodeScreen")}catch(E){f({errorModalData:{error:E,previousScreen:w||"LandingScreen"}}),n("ErrorScreen")}u(!1)})(h):(f({captchaModalData:{callback:r=>{if(!i?.email)throw Error("User is required to have an email address to update it.");return p({oldAddress:i.email.address,newAddress:a,captchaToken:r})},userIntentRequired:!1,onSuccessNavigateTo:"AwaitingPasswordlessCodeScreen",onErrorNavigateTo:"ErrorScreen"}}),n("CaptchaScreen"))};return e.jsxs(e.Fragment,{children:[e.jsxs(V,{children:[t&&e.jsx(F,{style:{marginTop:"0.25rem",textAlign:"left"},children:t}),e.jsxs(K,{$error:!!t,children:[e.jsx(I,{children:e.jsx(L,{})}),e.jsx("input",{ref:l,id:"email-input",type:"email",placeholder:"your@email.com",onChange:r=>S(r.target.value),onKeyUp:r=>{r.key==="Enter"&&m()},value:a,autoComplete:"email"}),s.stacked?null:e.jsx(P,{isSubmitting:d,onClick:m,disabled:x,children:"Submit"})]})]}),s.stacked?e.jsx(q,{loadingText:null,loading:d,disabled:x,onClick:m,style:{width:"100%"},children:"Submit"}):null]})}));let V=D,K=R;const z=({title:s="Update your email",subtitle:l="Add the email address you'd like to use going forward. We'll send you a confirmation code"})=>e.jsx(W,{title:s,subtitle:l,icon:y,watermark:!0,children:e.jsx(A,{children:e.jsx(N,{stacked:!0})})}),te={component:()=>e.jsx(z,{})};export{te as UpdateEmailScreen,z as UpdateEmailScreenView,te as default};
