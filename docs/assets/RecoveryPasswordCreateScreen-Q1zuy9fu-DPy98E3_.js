import{j as A}from"./vendor-wallet-iWeBopzN.js";import{r as a}from"./vendor-react-NLnOsXgy.js";import{a as T,r as M,bw as W,b as j,I as R,bp as L,by as S}from"./index-BF3dHrK7.js";import{u as $,o as D}from"./SetWalletPasswordForm-0nuoz3XZ-Dl511I1y.js";import"./ExclamationTriangleIcon-C_T-rHXN.js";import"./Layouts-BlFm53ED-uJnu7zYf.js";import"./ModalHeader-D8-mhjp4-DlVLsm2K.js";import"./shared-CwuyxHmv-B_mz9oBD.js";import"./Checkbox-BhNoOKjX-DWMNyV1A.js";import"./CheckCircleIcon-BMq0VCCt.js";import"./ScreenHeader-CHmc4-Lu-BCclGuxs.js";const J={component:()=>{let{navigate:u,data:b,onUserCloseViaDialogOrKeybindRef:v}=T(),C=M(),[g,x]=a.useState(""),[c,d]=a.useState(!1),[s,h]=a.useState(),[n,P]=a.useState(null),{create:r}=W(),{authenticated:m,user:o}=j(),{closePrivyModal:l,isNewUserThisSession:E,initializeWalletProxy:U}=R(),{onSuccess:p,onFailure:i,callAuthOnSuccessOnClose:w,shouldCreateEth:f,shouldCreateSol:y}=b.createWallet,[t,I]=a.useState(null),O=new L((async()=>{try{let e;if(f&&y)e=await r({recoveryMethod:"user-passcode",recoveryPassword:s,chainType:"ethereum",walletIndex:0,latestUser:o}),e=await r({chainType:"solana",walletIndex:0,latestUser:e.user});else if(y)e=await r({recoveryMethod:"user-passcode",recoveryPassword:s,chainType:"solana",walletIndex:0,latestUser:o});else{if(!f)throw Error("Invalid args to create wallet");e=await r({recoveryMethod:"user-passcode",recoveryPassword:s,chainType:"ethereum",walletIndex:0,latestUser:o})}I(e),E?u("EmbeddedWalletCreatedScreen"):(p(e),l({shouldCallAuthOnSuccess:w}))}catch(e){x(e.message)}}));return a.useEffect((()=>{n||U(3e4).then((e=>P(e)))}),[n]),a.useEffect((()=>{if(!m||!o)return u("LandingScreen"),void i(Error("User must be authenticated before creating a Privy wallet"))}),[m]),v.current=()=>null,A.jsx($,{config:{initiatedBy:"automatic"},appName:C?.name||"privy",loading:!n,buttonLoading:c,buttonHideAnimations:!t&&c,isResettingPassword:!1,error:g,password:s||"",onClose:()=>{t&&t.account.recoveryMethod!=="user-passcode"?(i(new S("User created a wallet but failed to set a password for it")),l({shouldCallAuthOnSuccess:!1})):t?(p(t),l({shouldCallAuthOnSuccess:w})):(i(new S("User wallet creation failed")),l({shouldCallAuthOnSuccess:!1}))},onPasswordChange:h,onPasswordGenerate:()=>h(D()),onSubmit:async()=>(d(!0),O.execute().then((()=>new Promise((e=>setTimeout(e,250))))).finally((()=>d(!1))))})}};export{J as EmbeddedWalletPasswordCreateScreen,J as default};
