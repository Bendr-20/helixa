import{j as a,aO as f}from"./vendor-wallet-iWeBopzN.js";import{r as i}from"./vendor-react-NLnOsXgy.js";import{m as z,u as H}from"./ModalHeader-D8-mhjp4-idcyyJVk.js";import{d as V}from"./Layouts-BlFm53ED-SRVhpBUn.js";import{C as W}from"./QrCode-C1tgJtOy-iFKEeh4P.js";import{t as Y}from"./FundWalletMethodHeader-Cfci4-83-BtzElGDm.js";import{i as G}from"./InfoBanner-DkQEPd77-DiTtvuBZ.js";import{r as J}from"./Subtitle-CV-2yKE4-DVwjrzL4.js";import{e as K}from"./Title-BnzYV3Is-CcF3k3X9.js";import{j as Q}from"./WalletInfoCard-DFt8ndGE-Bye_qeey.js";import{n as X,I,c7 as Z,a as _,r as ee,q as D,M as re,cf as ae}from"./index-DOPD16Fz.js";import{s as ne}from"./useWalletBalance-CDyi5_iR-bqc_3yom.js";import{t as M}from"./analytics-mkkvFRju-DOXuftJB.js";import{e as se}from"./getChainName-DjpPdUSc-c2urPd0g.js";import{r as h}from"./getUsdcMintAddress-DFI1hv05-jlhpBW9a.js";import{t as te}from"./transaction-CnfuREWo-nROljJQP.js";import{n as ie}from"./getErc20Balance-DA4dGV9O-CHa6fqyU.js";import"./browser-CxT9TM-V.js";import{i as b,t as oe}from"./formatters-DwTIoOJg.js";import"./ErrorMessage-D8VaAP5m-DXLnMoFv.js";import"./LabelXs-oqZNqbm_-BEJpG7MF.js";import"./Address-BjZb-TIL-hBpAKg2Y.js";import"./check-B9ysh8c4.js";import"./createLucideIcon-4wkIQryq.js";import"./copy-BmDK-JXv.js";import"./shared-FM0rljBt-N4c19p5w.js";import"./getFormattedUsdFromLamports-B6EqSEho-C-HCdwKa.js";const Oe={component:()=>{let{wallets:d}=X(),{connectors:w}=I(),A=w.filter(Z).flatMap((s=>s.wallets)),{data:c,setModalData:F,navigate:k,lastScreen:U}=_(),{rpcConfig:g,appId:C,createAnalyticsEvent:v,closePrivyModal:E}=I(),y=ee(),[r,l]=i.useState(void 0),[B,S]=i.useState(!1),e=c?.funding,{reloadBalance:O}=ne({rpcConfig:g,appId:C,address:e.chainType==="ethereum"?e.address:void 0,chain:e.chainType==="ethereum"?e.chain:void 0}),o=e.chainType==="solana",m=o?e.isUSDC?"USDC":"SOL":e.erc20Address?e.erc20ContractInfo?.symbol:e.chain.nativeCurrency.symbol,$=o?A.find((({address:s})=>s===e.address)):d.find((({address:s})=>D(s)===D(e.address)));if(!e)return F({errorModalData:{error:Error("Couldn't find funding config"),previousScreen:U||"FundingMethodSelectionScreen"},funding:c?.funding,solanaFundingData:c?.solanaFundingData,sendTransaction:c?.sendTransaction}),k("ErrorScreen"),a.jsx(a.Fragment,{});i.useEffect((()=>{let s=o?async function(){if(e.chainType!=="solana")return;let n=y.solanaRpcs[e.chain];n?(e.isUSDC?(async function({rpc:p,address:t,mintAddress:N}){let P=await p.getTokenAccountsByOwner(t,{mint:N},{encoding:"jsonParsed",commitment:"confirmed"}).send(),j=P.value[0]?.account;return j?BigInt(j.data.parsed.info.tokenAmount.amount):0n})({rpc:n.rpc,address:e.address,mintAddress:h(e.chain)}):re({rpc:n.rpc,address:e.address})).then((p=>{let t=BigInt(p);r&&t>r&&(S(!0),v({eventName:M,payload:{provider:"manual",status:"success",chainType:"solana",address:$?.address,value:e.isUSDC?f(t-r,6):f(t-r,9),token:e.isUSDC?"USDC":"SOL"}})),l(t)})):console.warn("Unable to load solana rpc, skipping balance")}:async function(){e.chainType==="ethereum"&&(async()=>{if(!e.erc20Address)return await O()??BigInt(0);{let{balance:n}=await ie({chain:e.chain,address:e.address,erc20Address:e.erc20Address,rpcConfig:g,appId:C});return n}})().then((n=>{r&&n>r&&(S(!0),v({eventName:M,payload:{provider:"manual",status:"success",chainType:"ethereum",address:$?.address,chainId:e.chain.id,value:f(n-r,e.erc20ContractInfo?.decimals??18),token:e.erc20ContractInfo?.symbol??e.erc20Address??"ETH"}})),l(n)})).catch((()=>l(void 0)))},q=setInterval(s,2e3);return s(),()=>clearInterval(q)}),[r]);let L=i.useMemo((()=>r==null?"":e.isUSDC?b({amount:r,decimals:6}):o?te(r,3,!0,!0):e.erc20ContractInfo?.decimals!=null?b({amount:r,decimals:e.erc20ContractInfo.decimals}):oe({wei:r})),[r,o,e]),u=e.chainType==="ethereum"?e.chain.name:se(e.chain),x=i.useMemo((()=>e.uiConfig?.receiveFundsTitle===""?null:a.jsx(K,{children:e.uiConfig?.receiveFundsTitle??`Receive ${e.amount} ${m??""}`.trim()})),[e.uiConfig?.receiveFundsTitle,e.amount,m]),T=i.useMemo((()=>e.uiConfig?.receiveFundsSubtitle===""?null:a.jsx(J,{children:e.uiConfig?.receiveFundsSubtitle??`Scan this code or copy your wallet address to receive funds on ${u}.`})),[e.uiConfig?.receiveFundsSubtitle,u]),R=e.chainType==="solana"&&e.isUSDC&&h(e.chain)?`?spl-token=${h(e.chain)}`:"";return a.jsxs(a.Fragment,{children:[a.jsx(Y,{}),x,T,a.jsxs(V,{style:{gap:"1rem",margin:x||T?"1rem 0":"0"},children:[a.jsx(W,{url:`${e.chainType}:${e.address}${R}`,size:200,squareLogoElement:ce}),a.jsxs(G,{theme:y.appearance.palette.colorScheme,children:["Make sure to send funds on ",u,"."]}),a.jsx(Q,{title:"Your wallet",errMsg:void 0,showCopyButton:!0,balance:`${L} ${m}`,address:e.address}),B&&a.jsx(z,{onClick:()=>E({shouldCallAuthOnSuccess:!1,isSuccess:!0}),children:"Continue"})]}),a.jsx(H,{})]})}};let ce=({...d})=>a.jsx(ae,{color:"black",...d});export{Oe as ManualTransferScreen,Oe as default};
