import{j as u}from"./vendor-wallet-F4boqawy.js";import{r}from"./vendor-react-BtAbuqlL.js";import{b as M,r as B,co as E}from"./index-DTmhzp_L.js";import{K as j,R as C,q as A,X as g}from"./to-ui-error-REESv0kM-CLWTvawp.js";import"./PinInput-3SLvbnQa-BHCeQMka.js";import"./FingerPrintIcon-BTJJ6Anb.js";import"./PhoneIcon-Dit1GU1k.js";import"./ShieldCheckIcon-CggTZsHC.js";import"./ModalHeader-D8-mhjp4-qoJ1wz7E.js";import"./ScreenLayout-DTmQLGPf-D7jqh1U-.js";import"./Screen-Bp-TN9gb-DOXOKuwN.js";import"./index-Dq_xe9dz-CNmL4A7L.js";import"./ExclamationTriangleIcon-Cx19WewI.js";import"./StackedContainer-B2vaEl56-oL27kMwY.js";import"./useGetTokenPrice-BPBpM07F-CtgFfu4j.js";import"./useGetSolPrice-DwwjjGbd-DAJ5qoyV.js";import"./TransactionDetails-BurRo8R0-ljYJD68W.js";import"./WalletLink--05Hzo2b-Dc1yGUJE.js";import"./ethers-D1WT71Ay-x0xgUKdd.js";import"./getFormattedUsdFromLamports-B6EqSEho-C-HCdwKa.js";import"./transaction-CnfuREWo-nROljJQP.js";import"./Layouts-BlFm53ED-D6CI-Dtb.js";import"./ChevronDownIcon-CrOO2JkX.js";const _=({onClose:n})=>{let{user:l}=M(),p=B(),a=r.useMemo((()=>l?.mfaMethods.filter((t=>t!=="passkey"||!p.globalDisablePasskeys))??[]),[l?.mfaMethods,p.globalDisablePasskeys]),[o,i]=r.useState(a[0]??null),{init:d,cancel:w,submit:h}=E(),[y,k]=r.useState(!1),[v,x]=r.useState(null),[c,s]=r.useState();r.useEffect((()=>{i(a[0]??null)}),[a]);let m=r.useRef(!1);async function b(t){s(void 0);try{if(!t||!o)return;await h(o,t),k(!0),s(void 0),n()}catch(e){throw g(e).error}}async function S(t){if(t!=="passkey")try{i(t),await d(t)}catch(e){console.error(e)}else try{i(t);let e=await d(t);if(!e)throw Error("something went wrong");x(e),await h(t,e),k(!0),s(void 0),n()}catch(e){s(g(e))}}r.useEffect((()=>{!m.current&&o&&(m.current=!0,S(o).finally((()=>{m.current=!1})))}),[]);let f=()=>{i(null),s(void 0),w(),n()};return l?o==="passkey"?u.jsx(j,{account:l.linkedAccounts.filter((t=>t.type==="passkey"&&t.enrolledInMfa)).sort(((t,e)=>e.firstVerifiedAt.valueOf()-t.firstVerifiedAt.valueOf()))[0],submitSuccess:y,hasBlockingError:c?.isBlocking??!1,error:c?.error,onClose:f,onBack:()=>{i(null),s(void 0)},handleSubmit:()=>b(v).catch(s)}):o?u.jsx(C,{submitSuccess:y,hasBlockingError:c?.isBlocking??!1,handleSubmitCode:b,selectedMethod:o,onClose:f,onBack:a.length>1?()=>i(null):void 0}):u.jsx(A,{mfaMethods:a,onSelect:S,handleClose:f}):null};export{_ as MfaVerifyFlowScreen,_ as default};
